/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.nifi.web.security.anonymous;

import java.nio.file.Paths;
import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

public class NiFiAnonymousAuthenticationAllowList {

    private static final Set<String> allowedFiles = new HashSet<>(Arrays.asList(
        "FontAwesome.otf",
        "Roboto-Bold.ttf",
        "Roboto-Italic.ttf",
        "Roboto-Light.ttf",
        "Roboto-LightItalic.ttf",
        "Roboto-Medium.ttf",
        "Roboto-Regular.ttf",
        "RobotoSlab-Bold.ttf",
        "RobotoSlab-Regular.ttf",
        "about-dialog.jsp",
        "action-details-dialog.jsp",
        "angular-animate.min.js",
        "angular-animate.min.js.map",
        "angular-aria.min.js",
        "angular-aria.min.js.map",
        "angular-csp.css",
        "angular-material.min.css",
        "angular-material.min.js",
        "angular-messages.min.js",
        "angular-messages.min.js.map",
        "angular-resource.min.js",
        "angular-resource.min.js.map",
        "angular-route.min.js",
        "angular-route.min.js.map",
        "angular-sanitize.min.js",
        "angular-sanitize.min.js.map",
        "angular-ui-router.js",
        "angular-ui-router.min.js",
        "angular.js",
        "angular.min.js",
        "angular.min.js.gzip",
        "angular.min.js.map",
        "app.js",
        "application.js",
        "banners-main.jsp",
        "banners-utility.jsp",
        "beautify.js",
        "bg-error.png",
        "bgInputText.png",
        "bgNifiLogo.png",
        "bower.json",
        "bulletin-board-content.jsp",
        "bulletin-board.jsp",
        "buttonNew.png",
        "buttonNewProperty.png",
        "canvas-header.jsp",
        "canvas.jsp",
        "cluster-connection-summary-dialog.jsp",
        "cluster-content.jsp",
        "cluster-input-port-summary-dialog.jsp",
        "cluster-output-port-summary-dialog.jsp",
        "cluster-process-group-summary-dialog.jsp",
        "cluster-processor-summary-dialog.jsp",
        "cluster-remote-process-group-summary-dialog.jsp",
        "cluster.jsp",
        "codemirror-compressed.js",
        "codemirror-compressed.js.gz",
        "codemirror.css",
        "codemirror.css.gz",
        "codemirror.jsp",
        "codemirror.spec.js",
        "collapse.gif",
        "common-ui.css",
        "common-ui.css.gz",
        "common.js",
        "component-state-dialog.jsp",
        "component-version-dialog.jsp",
        "connection-configuration.jsp",
        "connection-details.jsp",
        "connections-dialog.jsp",
        "controller-service-configuration.jsp",
        "counters-content.jsp",
        "counters.jsp",
        "d3-selection-multi.min.js",
        "d3.min.js",
        "demo.css",
        "demo.html",
        "demo.js",
        "disable-controller-service-dialog.jsp",
        "drop-request-status-dialog.jsp",
        "enable-controller-service-dialog.jsp",
        "error.state.js",
        "error.view.html",
        "expand.gif",
        "fill-color-dialog.jsp",
        "flow-status.jsp",
        "flowfile-details-dialog.jsp",
        "flowfont.css",
        "flowfont.css.gz",
        "flowfont.eot",
        "flowfont.svg",
        "flowfont.ttf",
        "flowfont.woff",
        "flowfont.woff2",
        "foldgutter.css",
        "foldgutter.css.gz",
        "font-awesome.css",
        "font-awesome.css.map",
        "font-awesome.min.css",
        "fontawesome-webfont.eot",
        "fontawesome-webfont.svg",
        "fontawesome-webfont.ttf",
        "fontawesome-webfont.woff",
        "fontawesome-webfont.woff2",
        "footer.jsp",
        "gruntFile.js",
        "header.jsp",
        "hexview.default.css",
        "hexview.js",
        "hexview.jsp",
        "history-content.jsp",
        "history-filter-dialog.jsp",
        "history-purge-dialog.jsp",
        "history.jsp",
        "iconDelete.png",
        "iconInfo.png",
        "iconLoading.gif",
        "iconResize.png",
        "import-flow-version-dialog.jsp",
        "index.html",
        "index.js",
        "index.jsp",
        "inputCheckbox.png",
        "instantiate-template-dialog.jsp",
        "jquery-ui.min.css",
        "jquery-ui.min.js",
        "jquery.base64.js",
        "jquery.base64.js.gz",
        "jquery.center.js",
        "jquery.center.js.gz",
        "jquery.combo.css",
        "jquery.combo.css.gz",
        "jquery.combo.js",
        "jquery.combo.js.gz",
        "jquery.count.js",
        "jquery.count.js.gz",
        "jquery.each.js",
        "jquery.each.js.gz",
        "jquery.ellipsis.js",
        "jquery.ellipsis.js.gz",
        "jquery.event.drag-2.3.0.js",
        "jquery.form.js",
        "jquery.min.js",
        "jquery.min.map",
        "jquery.minicolors.css",
        "jquery.minicolors.min.js",
        "jquery.minicolors.png",
        "jquery.modal.css",
        "jquery.modal.css.gz",
        "jquery.modal.js",
        "jquery.modal.js.gz",
        "jquery.nfeditor.css",
        "jquery.nfeditor.css.gz",
        "jquery.nfeditor.js",
        "jquery.nfeditor.js.gz",
        "jquery.propertytable.css",
        "jquery.propertytable.css.gz",
        "jquery.propertytable.js",
        "jquery.propertytable.js.gz",
        "jquery.qtip.css",
        "jquery.qtip.min.css",
        "jquery.qtip.min.js",
        "jquery.qtip.min.map",
        "jquery.statusbar.css",
        "jquery.statusbar.css.gz",
        "jquery.statusbar.js",
        "jquery.statusbar.js.gz",
        "jquery.tab.js",
        "jquery.tab.js.gz",
        "jquery.tabbs.css",
        "jquery.tabbs.css.gz",
        "jquery.tabbs.js",
        "jquery.tabbs.js.gz",
        "jquery.tagcloud.css",
        "jquery.tagcloud.css.gz",
        "jquery.tagcloud.js",
        "jquery.tagcloud.js.gz",
        "json-lint.js",
        "json-lint.js.gz",
        "json2.js",
        "jsonlint.js",
        "karma.conf.js",
        "label-configuration.jsp",
        "lineage-query-dialog.jsp",
        "lint.css",
        "lint.css.gz",
        "lint.js",
        "lint.js.gz",
        "listing-request-status-dialog.jsp",
        "lodash-core.min.js",
        "login-form.jsp",
        "login-message.jsp",
        "login-progress.jsp",
        "login-submission.jsp",
        "login.jsp",
        "logout-message.jsp",
        "logout.jsp",
        "main.controller.js",
        "main.css",
        "main.state.js",
        "menuArrow.png",
        "menuArrowSmall.png",
        "message-page.css",
        "message-page.css.gz",
        "message-page.jsp",
        "message-pane.css",
        "message-pane.css.gz",
        "message-pane.jsp",
        "moment.min.js",
        "navigation.jsp",
        "new-controller-service-dialog.jsp",
        "new-parameter-context-dialog.jsp",
        "new-port-dialog.jsp",
        "new-process-group-dialog.jsp",
        "new-processor-dialog.jsp",
        "new-remote-process-group-dialog.jsp",
        "new-reporting-task-dialog.jsp",
        "new-template-dialog.jsp",
        "nf-ajax-setup.js",
        "nf-ajax-setup.js.gz",
        "nf-bulletin-board-all.css",
        "nf-bulletin-board-all.css.gz",
        "nf-bulletin-board-all.js",
        "nf-bulletin-board-all.js.gz",
        "nf-canvas-all.css",
        "nf-canvas-all.css.gz",
        "nf-canvas-all.js",
        "nf-canvas-all.js.gz",
        "nf-cluster-all.css",
        "nf-cluster-all.css.gz",
        "nf-cluster-all.js",
        "nf-cluster-all.js.gz",
        "nf-common-ui.css",
        "nf-common-ui.css.gz",
        "nf-counters-all.css",
        "nf-counters-all.css.gz",
        "nf-counters-all.js",
        "nf-counters-all.js.gz",
        "nf-history-all.css",
        "nf-history-all.css.gz",
        "nf-history-all.js",
        "nf-history-all.js.gz",
        "nf-login-all.css",
        "nf-login-all.css.gz",
        "nf-login-all.js",
        "nf-login-all.js.gz",
        "nf-logout-all.css",
        "nf-logout-all.css.gz",
        "nf-logout-all.js",
        "nf-logout-all.js.gz",
        "nf-namespace.js",
        "nf-namespace.js.gz",
        "nf-ng-breadcrumbs-directive-view.html",
        "nf-ng-canvas-namespace.js",
        "nf-ng-canvas-namespace.js.gz",
        "nf-ng-namespace.js",
        "nf-ng-namespace.js.gz",
        "nf-provenance-all.css",
        "nf-provenance-all.css.gz",
        "nf-provenance-all.js",
        "nf-provenance-all.js.gz",
        "nf-provenance-lineage.js",
        "nf-provenance-lineage.js.gz",
        "nf-status-history.js",
        "nf-status-history.js.gz",
        "nf-storage.js",
        "nf-storage.js.gz",
        "nf-summary-all.css",
        "nf-summary-all.css.gz",
        "nf-summary-all.js",
        "nf-summary-all.js.gz",
        "nf-templates-all.css",
        "nf-templates-all.css.gz",
        "nf-templates-all.js",
        "nf-templates-all.js.gz",
        "nf-universal-capture.js",
        "nf-universal-capture.js.gz",
        "nf-users-all.css",
        "nf-users-all.css.gz",
        "nf-users-all.js",
        "nf-users-all.js.gz",
        "nfeditor.css",
        "nfeditor.css.gz",
        "nfel.js",
        "nfel.js.gz",
        "nfpr.js",
        "nfpr.js.gz",
        "nifi-drop-splash.svg",
        "nifi-drop.svg",
        "nifi-logo-about.svg",
        "nifi-logo.svg",
        "nifi16.ico",
        "no-viewer.jsp",
        "node-details-dialog.jsp",
        "ok-dialog.jsp",
        "override-policy-dialog.jsp",
        "parameter-contexts-content.jsp",
        "policy-management.jsp",
        "port-configuration.jsp",
        "port-details.jsp",
        "process-group-configuration.jsp",
        "processor-configuration.jsp",
        "processor-details.jsp",
        "processor.service.js",
        "provenance-content.jsp",
        "provenance-event-details-dialog.jsp",
        "provenance-query-dialog.jsp",
        "provenance-search-dialog.jsp",
        "provenance.jsp",
        "publish.js",
        "queue-listing.jsp",
        "registry-configuration-dialog.jsp",
        "remote-port-configuration.jsp",
        "remote-process-group-configuration.jsp",
        "remote-process-group-details.jsp",
        "remote-process-group-ports.jsp",
        "reporting-task-configuration.jsp",
        "reset.css",
        "resolve.js",
        "revert-local-changes-dialog.jsp",
        "save-flow-version-dialog.jsp",
        "search-users-dialog.jsp",
        "settings-content.jsp",
        "shell.jsp",
        "show-hint.css",
        "show-hint.css.gz",
        "show-local-changes-dialog.jsp",
        "slick-nifi-theme.css",
        "slick-nifi-theme.css.gz",
        "slick.autotooltips.js",
        "slick.cellrangedecorator.js",
        "slick.cellrangeselector.js",
        "slick.cellselectionmodel.js",
        "slick.core.js",
        "slick.dataview.js",
        "slick.editors.js",
        "slick.formatters.js",
        "slick.grid.css",
        "slick.grid.js",
        "slick.rowselectionmodel.js",
        "sort-asc.gif",
        "sort-desc.gif",
        "spacer.png",
        "state.js",
        "stateDirectives.js",
        "stateFilters.js",
        "status-history-dialog.jsp",
        "summary-content.jsp",
        "summary.jsp",
        "system-diagnostics-dialog.jsp",
        "templateFactory.js",
        "templates-content.jsp",
        "templates.jsp",
        "transformjson.controller.js",
        "transformjson.service.js",
        "transformjson.state.js",
        "transformjson.view.html",
        "ui-codemirror.js",
        "ui-icons_444444_256x240.png",
        "ui-icons_555555_256x240.png",
        "ui-icons_777620_256x240.png",
        "ui-icons_777777_256x240.png",
        "ui-icons_cc0000_256x240.png",
        "ui-icons_ffffff_256x240.png",
        "upload-template-dialog.jsp",
        "url-search-params.js",
        "urlMatcherFactory.js",
        "urlRouter.js",
        "user-delete-dialog.jsp",
        "user-dialog.jsp",
        "user-policies-dialog.jsp",
        "users-content.jsp",
        "users.jsp",
        "variable-configuration.jsp",
        "variable-dialog-template.html",
        "view-single-node-dialog.jsp",
        "view.js",
        "viewDirective.js",
        "viewScroll.js",
        "worksheet.jsp",
        "yes-no-dialog.jsp")
    );

    public static boolean isRequestedResourceInAllowList(final String servletPath) {
        String requestedStaticResource = getFileName(servletPath);
        return allowedFiles.contains(requestedStaticResource);
    }

    private static String getFileName(final String servletPath) {
        return Paths.get(servletPath).getFileName().toString();
    }
}
